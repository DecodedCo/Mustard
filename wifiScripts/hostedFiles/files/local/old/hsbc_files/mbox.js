var mboxCopyright="Copyright 1996-2012. Adobe Systems Incorporated. All rights reserved.";mboxUrlBuilder=function(a,b){this.a=a;this.b=b;this.c=[];this.d=function(a){return a};this.f=null};mboxUrlBuilder.prototype.addParameter=function(a,b){if(/('|")/.exec(a))throw"Parameter '"+a+"' contains invalid characters";for(var c=0;c<this.c.length;c++){var d=this.c[c];if(d.name==a)return d.value=b,this}c={};c.name=a;c.value=b;this.c[this.c.length]=c;return this};
mboxUrlBuilder.prototype.addParameters=function(a){if(!a)return this;for(var b=0;b<a.length;b++){var c=a[b].indexOf("=");c==-1||c==0||this.addParameter(a[b].substring(0,c),a[b].substring(c+1,a[b].length))}return this};mboxUrlBuilder.prototype.setServerType=function(a){this.o=a};mboxUrlBuilder.prototype.setBasePath=function(a){this.f=a};mboxUrlBuilder.prototype.setUrlProcessAction=function(a){this.d=a};
mboxUrlBuilder.prototype.buildUrl=function(){for(var a=(document.location.protocol=="file:"?"http:":document.location.protocol)+"//"+this.a+(this.f?this.f:"/m2/"+this.b+"/mbox/"+this.o),b=a.indexOf("?")!=-1?"&":"?",c=0;c<this.c.length;c++){var d=this.c[c];a+=b+encodeURIComponent(d.name)+"="+encodeURIComponent(d.value);b="&"}return this.t(this.d(a))};mboxUrlBuilder.prototype.getParameters=function(){return this.c};mboxUrlBuilder.prototype.setParameters=function(a){this.c=a};
mboxUrlBuilder.prototype.clone=function(){var a=new mboxUrlBuilder(this.a,this.b);a.setServerType(this.o);a.setBasePath(this.f);a.setUrlProcessAction(this.d);for(var b=0;b<this.c.length;b++)a.addParameter(this.c[b].name,this.c[b].value);return a};mboxUrlBuilder.prototype.t=function(a){return a.replace(/\"/g,"&quot;").replace(/>/g,"&gt;")};mboxStandardFetcher=function(){};mboxStandardFetcher.prototype.getType=function(){return"standard"};
mboxStandardFetcher.prototype.fetch=function(a){a.setServerType(this.getType());document.write('<script src="'+a.buildUrl()+'" language="JavaScript"><\/script>')};mboxStandardFetcher.prototype.cancel=function(){};mboxAjaxFetcher=function(){};mboxAjaxFetcher.prototype.getType=function(){return"ajax"};mboxAjaxFetcher.prototype.fetch=function(a){a.setServerType(this.getType());a=a.buildUrl();this.x=document.createElement("script");this.x.src=a;document.body.appendChild(this.x)};
mboxAjaxFetcher.prototype.cancel=function(){};mboxMap=function(){this.y={};this.z=[]};mboxMap.prototype.put=function(a,b){this.y[a]||(this.z[this.z.length]=a);this.y[a]=b};mboxMap.prototype.get=function(a){return this.y[a]};mboxMap.prototype.remove=function(a){this.y[a]=void 0};mboxMap.prototype.each=function(a){for(var b=0;b<this.z.length;b++){var c=this.z[b],d=this.y[c];if(d&&a(c,d)===false)break}};
mboxFactory=function(a,b,c){this.E=false;this.C=a;this.D=c;this.F=new mboxList;mboxFactories.put(c,this);this.H=(this.G=typeof document.createElement("div").replaceChild!="undefined"&&typeof document.getElementById!="undefined"&&typeof(window.attachEvent||document.addEventListener||window.addEventListener)!="undefined"&&typeof encodeURIComponent!="undefined")&&mboxGetPageParameter("mboxDisable")==null;var d=c=="default";this.J=new mboxCookieManager("mbox"+(d?"":"-"+c),mboxCookiePageDomain());this.H=
this.H&&this.J.isEnabled()&&this.J.getCookie("disable")==null;this.isAdmin()&&this.enable();this.K();this.L=mboxGenerateId();this.M=mboxScreenHeight();this.N=mboxScreenWidth();this.O=mboxBrowserWidth();this.P=mboxBrowserHeight();this.Q=mboxScreenColorDepth();this.R=mboxBrowserTimeOffset();this.S=new mboxSession(this.L,"mboxSession","session",1860,this.J);this.T=new mboxPC("PC",1209600,this.J);this.w=new mboxUrlBuilder(a,b);this.U(this.w,d);this.W=this.V=(new Date).getTime();var e=this;this.addOnLoad(function(){e.W=
(new Date).getTime()});if(this.G&&(this.addOnLoad(function(){e.E=true;e.getMboxes().each(function(a){a.setFetcher(new mboxAjaxFetcher);a.finalize()})}),this.H))this.limitTraffic(100,10368E3),this.Z(),this._=new mboxSignaler(function(a,b){return e.create(a,b)},this.J)};mboxFactory.prototype.isEnabled=function(){return this.H};mboxFactory.prototype.getDisableReason=function(){return this.J.getCookie("disable")};mboxFactory.prototype.isSupported=function(){return this.G};
mboxFactory.prototype.disable=function(a,b){typeof a=="undefined"&&(a=3600);typeof b=="undefined"&&(b="unspecified");if(!this.isAdmin())this.H=false,this.J.setCookie("disable",b,a)};mboxFactory.prototype.enable=function(){this.H=true;this.J.deleteCookie("disable")};mboxFactory.prototype.isAdmin=function(){return document.location.href.indexOf("mboxEnv")!=-1};mboxFactory.prototype.limitTraffic=function(){};
mboxFactory.prototype.addOnLoad=function(a){if(this.isDomLoaded())a();else{var b=false,c=function(){b||(b=true,a())};this.hb.push(c);this.isDomLoaded()&&!b&&c()}};mboxFactory.prototype.getEllapsedTime=function(){return this.W-this.V};mboxFactory.prototype.getEllapsedTimeUntil=function(a){return a-this.V};mboxFactory.prototype.getMboxes=function(){return this.F};mboxFactory.prototype.get=function(a,b){return this.F.get(a).getById(b||0)};
mboxFactory.prototype.update=function(a,b){if(this.isEnabled())if(this.isDomLoaded()){if(this.F.get(a).length()==0)throw"Mbox "+a+" is not defined";this.F.get(a).each(function(a){a.getUrlBuilder().addParameter("mboxPage",mboxGenerateId());a.load(b)})}else{var c=this;this.addOnLoad(function(){c.update(a,b)})}};
mboxFactory.prototype.create=function(a,b,c){if(!this.isSupported())return null;var d=this.w.clone();d.addParameter("mboxCount",this.F.length()+1);d.addParameters(b);var b=this.F.get(a).length(),e=this.D+"-"+a+"-"+b;if(c)c=new mboxLocatorNode(c);else{if(this.E)throw"The page has already been loaded, can't write marker";c=new mboxLocatorDefault(e)}try{var g=this,f=new mbox(a,b,d,c,"mboxImported-"+e);this.H&&f.setFetcher(this.E?new mboxAjaxFetcher:new mboxStandardFetcher);f.setOnError(function(a){f.setMessage(a);
f.activate();f.isActivated()||(g.disable(3600,a),window.location.reload(false))});this.F.add(f)}catch(h){throw this.disable(),'Failed creating mbox "'+a+'", the error was: '+h;}a=new Date;d.addParameter("mboxTime",a.getTime()-a.getTimezoneOffset()*6E4);return f};mboxFactory.prototype.getCookieManager=function(){return this.J};mboxFactory.prototype.getPageId=function(){return this.L};mboxFactory.prototype.getPCId=function(){return this.T};mboxFactory.prototype.getSessionId=function(){return this.S};
mboxFactory.prototype.getSignaler=function(){return this._};mboxFactory.prototype.getUrlBuilder=function(){return this.w};
mboxFactory.prototype.U=function(a,b){a.addParameter("mboxHost",document.location.hostname).addParameter("mboxSession",this.S.getId());b||a.addParameter("mboxFactoryId",this.D);this.T.getId()!=null&&a.addParameter("mboxPC",this.T.getId());a.addParameter("mboxPage",this.L);a.addParameter("screenHeight",this.M);a.addParameter("screenWidth",this.N);a.addParameter("browserWidth",this.O);a.addParameter("browserHeight",this.P);a.addParameter("browserTimeOffset",this.R);a.addParameter("colorDepth",this.Q);
a.setUrlProcessAction(function(a){a+="&mboxURL="+encodeURIComponent(document.location);var b=encodeURIComponent(document.referrer.split('?')[0]);a.length+b.length<2E3&&(a+="&mboxReferrer="+b);a+="&mboxVersion="+mboxVersion;return a})};mboxFactory.prototype.sb=function(){return""};mboxFactory.prototype.Z=function(){document.write("<style>.mboxDefault { visibility:hidden; }</style>")};mboxFactory.prototype.isDomLoaded=function(){return this.E};
mboxFactory.prototype.K=function(){if(this.hb==null){this.hb=[];var a=this;(function(){var b=document.addEventListener?"DOMContentLoaded":"onreadystatechange",c=false,d=function(){if(!c){c=true;for(var b=0;b<a.hb.length;++b)a.hb[b]()}};if(document.addEventListener)document.addEventListener(b,function(){document.removeEventListener(b,arguments.callee,false);d()},false),window.addEventListener("load",function(){document.removeEventListener("load",arguments.callee,false);d()},false);else if(document.attachEvent)if(self!==
self.top)document.attachEvent(b,function(){document.readyState==="complete"&&(document.detachEvent(b,arguments.callee),d())});else{var e=function(){try{document.documentElement.doScroll("left"),d()}catch(a){setTimeout(e,13)}};e()}document.readyState==="complete"&&d()})()}};mboxSignaler=function(a,b){this.J=b;for(var c=b.getCookieNames("signal-"),d=0;d<c.length;d++){var e=c[d],g=b.getCookie(e).split("&");a(g[0],g).load();b.deleteCookie(e)}};
mboxSignaler.prototype.signal=function(a,b){this.J.setCookie("signal-"+a,mboxShiftArray(arguments).join("&"),2700)};mboxList=function(){this.F=[]};mboxList.prototype.add=function(a){a!=null&&(this.F[this.F.length]=a)};mboxList.prototype.get=function(a){for(var b=new mboxList,c=0;c<this.F.length;c++){var d=this.F[c];d.getName()==a&&b.add(d)}return b};mboxList.prototype.getById=function(a){return this.F[a]};mboxList.prototype.length=function(){return this.F.length};
mboxList.prototype.each=function(a){if(typeof a!="function")throw"Action must be a function, was: "+typeof a;for(var b=0;b<this.F.length;b++)a(this.F[b])};mboxLocatorDefault=function(a){this.g="mboxMarker-"+a;document.write('<div id="'+this.g+'" style="visibility:hidden;display:none">&nbsp;</div>')};mboxLocatorDefault.prototype.locate=function(){for(var a=document.getElementById(this.g);a!=null;){if(a.nodeType==1&&a.className=="mboxDefault")return a;a=a.previousSibling}return null};
mboxLocatorDefault.prototype.force=function(){var a=document.createElement("div");a.className="mboxDefault";var b=document.getElementById(this.g);b.parentNode.insertBefore(a,b);return a};mboxLocatorNode=function(a){this.Eb=a};mboxLocatorNode.prototype.locate=function(){return typeof this.Eb=="string"?document.getElementById(this.Eb):this.Eb};mboxLocatorNode.prototype.force=function(){return null};mboxCreate=function(a){var b=mboxFactoryDefault.create(a,mboxShiftArray(arguments));b&&b.load();return b};
mboxDefine=function(a,b){return mboxFactoryDefault.create(b,mboxShiftArray(mboxShiftArray(arguments)),a)};mboxUpdate=function(a){mboxFactoryDefault.update(a,mboxShiftArray(arguments))};mbox=function(a,b,c,d,e){this.Kb=null;this.Lb=0;this.mb=d;this.nb=e;this.Mb=null;this.Nb=new mboxOfferContent;this.Fb=null;this.w=c;this.message="";this.Ob={};this.Pb=0;this.Ib=b;this.g=a;this.Qb();c.addParameter("mbox",a).addParameter("mboxId",b);this.Rb=function(){};this.Sb=function(){};this.Tb=null};
mbox.prototype.getId=function(){return this.Ib};mbox.prototype.Qb=function(){if(this.g.length>250)throw"Mbox Name "+this.g+" exceeds max length of 250 characters.";else if(this.g.match(/^\s+|\s+$/g))throw"Mbox Name "+this.g+" has leading/trailing whitespace(s).";};mbox.prototype.getName=function(){return this.g};mbox.prototype.getParameters=function(){for(var a=this.w.getParameters(),b=[],c=0;c<a.length;c++)a[c].name.indexOf("mbox")!=0&&(b[b.length]=a[c].name+"="+a[c].value);return b};
mbox.prototype.setOnLoad=function(a){this.Sb=a;return this};mbox.prototype.setMessage=function(a){this.message=a;return this};mbox.prototype.setOnError=function(a){this.Rb=a;return this};mbox.prototype.setFetcher=function(a){this.Mb&&this.Mb.cancel();this.Mb=a;return this};mbox.prototype.getFetcher=function(){return this.Mb};
mbox.prototype.load=function(a){if(this.Mb==null)return this;this.setEventTime("load.start");this.cancelTimeout();this.Lb=0;this.Mb.fetch(a&&a.length>0?this.w.clone().addParameters(a):this.w);var b=this;this.Vb=setTimeout(function(){b.Rb("browser timeout",b.Mb.getType())},15E3);this.setEventTime("load.end");return this};mbox.prototype.loaded=function(){this.cancelTimeout();if(!this.activate()){var a=this;setTimeout(function(){a.loaded()},100)}};
mbox.prototype.activate=function(){if(this.Lb)return this.Lb;this.setEventTime("activate"+ ++this.Pb+".start");if(this.show())this.cancelTimeout(),this.Lb=1;this.setEventTime("activate"+this.Pb+".end");return this.Lb};mbox.prototype.isActivated=function(){return this.Lb};mbox.prototype.setOffer=function(a){if(a&&a.show&&a.setOnLoad)this.Nb=a;else throw"Invalid offer";return this};mbox.prototype.getOffer=function(){return this.Nb};
mbox.prototype.show=function(){this.setEventTime("show.start");var a=this.Nb.show(this);this.setEventTime(a==1?"show.end.ok":"show.end");return a};mbox.prototype.showContent=function(a){if(a==null)return 0;if(this.Fb==null||!this.Fb.parentNode)if(this.Fb=this.getDefaultDiv(),this.Fb==null)return 0;if(this.Fb!=a)this.Xb(this.Fb),this.Fb.parentNode.replaceChild(a,this.Fb),this.Fb=a;this.Yb(a);this.Sb();return 1};
mbox.prototype.hide=function(){this.setEventTime("hide.start");var a=this.showContent(this.getDefaultDiv());this.setEventTime(a==1?"hide.end.ok":"hide.end.fail");return a};mbox.prototype.finalize=function(){this.setEventTime("finalize.start");this.cancelTimeout();this.getDefaultDiv()==null&&(this.mb.force()!=null?this.setMessage("No default content, an empty one has been added"):this.setMessage("Unable to locate mbox"));this.activate()||(this.hide(),this.setEventTime("finalize.end.hide"));this.setEventTime("finalize.end.ok")};
mbox.prototype.cancelTimeout=function(){this.Vb&&clearTimeout(this.Vb);this.Mb!=null&&this.Mb.cancel()};mbox.prototype.getDiv=function(){return this.Fb};mbox.prototype.getDefaultDiv=function(){if(this.Tb==null)this.Tb=this.mb.locate();return this.Tb};mbox.prototype.setEventTime=function(a){this.Ob[a]=(new Date).getTime()};mbox.prototype.getEventTimes=function(){return this.Ob};mbox.prototype.getImportName=function(){return this.nb};mbox.prototype.getURL=function(){return this.w.buildUrl()};
mbox.prototype.getUrlBuilder=function(){return this.w};mbox.prototype._b=function(a){return a.style.display!="none"};mbox.prototype.Yb=function(a){this.ac(a,true)};mbox.prototype.Xb=function(a){this.ac(a,false)};mbox.prototype.ac=function(a,b){a.style.visibility=b?"visible":"hidden";a.style.display=b?"block":"none"};mboxOfferContent=function(){this.Sb=function(){}};mboxOfferContent.prototype.show=function(a){a=a.showContent(document.getElementById(a.getImportName()));a==1&&this.Sb();return a};
mboxOfferContent.prototype.setOnLoad=function(a){this.Sb=a};mboxOfferAjax=function(a){this.Wb=a;this.Sb=function(){}};mboxOfferAjax.prototype.setOnLoad=function(a){this.Sb=a};mboxOfferAjax.prototype.show=function(a){var b=document.createElement("div");b.id=a.getImportName();b.innerHTML=this.Wb;a=a.showContent(b);a==1&&this.Sb();return a};mboxOfferDefault=function(){this.Sb=function(){}};mboxOfferDefault.prototype.setOnLoad=function(a){this.Sb=a};
mboxOfferDefault.prototype.show=function(a){a=a.hide();a==1&&this.Sb();return a};mboxCookieManager=function(a,b){this.g=a;this.dc=b==""||b.indexOf(".")==-1?"":"; domain="+b;this.ec=new mboxMap;this.loadCookies()};mboxCookieManager.prototype.isEnabled=function(){this.setCookie("check","true",60);this.loadCookies();return this.getCookie("check")=="true"};
mboxCookieManager.prototype.setCookie=function(a,b,c){if(typeof a!="undefined"&&typeof b!="undefined"&&typeof c!="undefined"){var d={};d.name=a;d.value=escape(b);d.expireOn=Math.ceil(c+(new Date).getTime()/1E3);this.ec.put(a,d);this.saveCookies()}};mboxCookieManager.prototype.getCookie=function(a){return(a=this.ec.get(a))?unescape(a.value):null};mboxCookieManager.prototype.deleteCookie=function(a){this.ec.remove(a);this.saveCookies()};
mboxCookieManager.prototype.getCookieNames=function(a){var b=[];this.ec.each(function(c){c.indexOf(a)==0&&(b[b.length]=c)});return b};mboxCookieManager.prototype.saveCookies=function(){var a=[],b=0;this.ec.each(function(c,e){a[a.length]=c+"#"+e.value+"#"+e.expireOn;if(b<e.expireOn)b=e.expireOn});if(document.cookie.indexOf("opt_in_status=1")!==-1){var c=new Date(b*1E3);document.cookie=this.g+"="+a.join("|")+"; expires="+c.toGMTString()+"; path=/"+this.dc}};
mboxCookieManager.prototype.loadCookies=function(){this.ec=new mboxMap;var a=document.cookie.indexOf(this.g+"=");if(a!=-1){var b=document.cookie.indexOf(";",a);if(b==-1&&(b=document.cookie.indexOf(",",a),b==-1))b=document.cookie.length;for(var a=document.cookie.substring(a+this.g.length+1,b).split("|"),b=Math.ceil((new Date).getTime()/1E3),c=0;c<a.length;c++){var d=a[c].split("#");if(b<=d[2]){var e={};e.name=d[0];e.value=d[1];e.expireOn=d[2];this.ec.put(e.name,e)}}}};
mboxSession=function(a,b,c,d,e){this.tc=b;this.Ab=c;this.uc=d;this.J=e;this.vc=false;this.Ib=typeof mboxForceSessionId!="undefined"?mboxForceSessionId:mboxGetPageParameter(this.tc);if(this.Ib==null||this.Ib.length==0)if(this.Ib=e.getCookie(c),this.Ib==null||this.Ib.length==0)this.Ib=a,this.vc=true;e.setCookie(c,this.Ib,d)};mboxSession.prototype.getId=function(){return this.Ib};mboxSession.prototype.forceId=function(a){this.Ib=a;this.J.setCookie(this.Ab,this.Ib,this.uc)};
mboxPC=function(a,b,c){this.Ab=a;this.uc=b;this.J=c;this.Ib=typeof mboxForcePCId!="undefined"?mboxForcePCId:c.getCookie(a);this.Ib!=null&&c.setCookie(a,this.Ib,b)};mboxPC.prototype.getId=function(){return this.Ib};mboxPC.prototype.forceId=function(a){return this.Ib!=a?(this.Ib=a,this.J.setCookie(this.Ab,this.Ib,this.uc),true):false};mboxGetPageParameter=function(a){var b=null,a=RegExp(a+"=([^&]*)").exec(document.location);a!=null&&a.length>=2&&(b=a[1]);return b};
mboxSetCookie=function(a,b,c){return mboxFactoryDefault.getCookieManager().setCookie(a,b,c)};mboxGetCookie=function(a){return mboxFactoryDefault.getCookieManager().getCookie(a)};mboxCookiePageDomain=function(){var a=/([^:]*)(:[0-9]{0,5})?/.exec(document.location.host)[1];if(!/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/.exec(a)){var b=/([^\.]+\.[^\.]{3}|[^\.]+\.[^\.]+\.[^\.]{2})$/.exec(a);b&&(a=b[0])}return a?a:""};mboxShiftArray=function(a){for(var b=[],c=1;c<a.length;c++)b[b.length]=a[c];return b};
mboxGenerateId=function(){return(new Date).getTime()+"-"+Math.floor(Math.random()*999999)};mboxScreenHeight=function(){return screen.height};mboxScreenWidth=function(){return screen.width};mboxBrowserWidth=function(){return window.innerWidth?window.innerWidth:document.documentElement?document.documentElement.clientWidth:document.body.clientWidth};mboxBrowserHeight=function(){return window.innerHeight?window.innerHeight:document.documentElement?document.documentElement.clientHeight:document.body.clientHeight};
mboxBrowserTimeOffset=function(){return-(new Date).getTimezoneOffset()};mboxScreenColorDepth=function(){return screen.pixelDepth};if(typeof mboxVersion=="undefined")var mboxVersion=41,mboxFactories=new mboxMap,mboxFactoryDefault=new mboxFactory("hsbc.tt.omtrdc.net","hsbc","default");
if(mboxGetPageParameter("mboxDebug")!=null||mboxFactoryDefault.getCookieManager().getCookie("debug")!=null)setTimeout(function(){typeof mboxDebugLoaded=="undefined"&&alert("Could not load the remote debug.\nPlease check your connection to Test&amp;Target servers")},3600),document.write('<script language="Javascript1.2" src="http://admin7.testandtarget.omniture.com/admin/mbox/mbox_debug.jsp?mboxServerHost=hsbc.tt.omtrdc.net&clientCode=hsbc"><\/script>');
var pageAlias = "", extraInfo = ""; if (window.tc_page_alias) pageAlias = "pageAlias=" + tc_page_alias; if (window.tc_extra_info) extraInfo = tc_extra_info.split("&"); var head = document.getElementsByTagName('head')[0]; var script = document.createElement('script'); script.type = 'text/javascript'; script.text = 'mboxCreate("Global_Mbox","' + pageAlias + '"'; for (var i = 0; i < extraInfo.length; i++) { script.text += ',"' + extraInfo[i] + '"' } script.text += ')'; head.appendChild(script);